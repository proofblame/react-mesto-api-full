{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"/Users/timurmarokko/Desktop/dev/react-mesto-auth/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/timurmarokko/Desktop/dev/react-mesto-auth/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/timurmarokko/Desktop/dev/react-mesto-auth/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import Header from\"./Header\";import Main from\"./Main\";import Footer from\"./Footer\";import EditProfilePopup from\"./EditProfilePopup\";import EditAvatarPopup from\"./EditAvatarPopup\";import ImagePopup from\"./ImagePopup\";import api from\"../utils/api\";import{CurrentUserContext}from\"../contexts/CurrentUserContext\";import ConfirmPopup from\"./ConfirmPopup\";import AddPlacePopup from\"./AddPlacePopup\";function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isEditProfilePopupOpen=_useState2[0],setIsEditProfilePopupOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAddPlacePopupOpen=_useState4[0],setIsAddPlacePopupOpen=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isEditAvatarPopupOpen=_useState6[0],setIsEditAvatarPopupOpen=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isConfirmPopupOpen=_useState8[0],setIsConfirmPopupOpen=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),selectedCard=_useState10[0],setSelectedCard=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),deleteCard=_useState12[0],setDeleteCard=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),currentUser=_useState14[0],setCurrentUser=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),cards=_useState16[0],setCards=_useState16[1];var _useState17=useState({submit:\"Сохранить\",confirm:\"Да\"}),_useState18=_slicedToArray(_useState17,2),valueInput=_useState18[0],setValueInput=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),nameError=_useState20[0],setNameError=_useState20[1];var _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),descriptionError=_useState22[0],setDescriptionError=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),formValid=_useState24[0],setFormValid=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),nameValid=_useState26[0],setNameValid=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),descriptionValid=_useState28[0],setDescriptionValid=_useState28[1];// Валидация изменения имени и названия\nfunction handleChangeName(event){if(event.target.validity.valid){setNameError(\"\");setNameValid(true);}else{setNameError(event.target.validationMessage);setNameValid(false);}}// Валидация изменения описания и ссылок\nfunction handleChangeDescription(event){if(event.target.validity.valid){setDescriptionError(\"\");setDescriptionValid(true);}else{setDescriptionError(event.target.validationMessage);setDescriptionValid(false);}}useEffect(function(){if(!nameValid||!descriptionValid){setFormValid(false);}else{setFormValid(true);}return function(){setFormValid(false);};},[nameValid,descriptionValid]);// useEffect(() => {\n//     if (nameError || descriptionError) {\n//         setFormValid(false);\n//     } else {\n//         setFormValid(true);\n//     }\n// },[nameError, descriptionError]);\n// Получение данных пользователя с сервера\nuseEffect(function(){api.getUserInfo().then(function(data){setCurrentUser(data);}).catch(function(err){console.log(err);});},[]);// Получение карточек с сервера\nuseEffect(function(){api.getInitialCards().then(function(cards){setCards(cards);}).catch(function(err){console.log(err);});},[]);//  Закрытие попапа по Esc и клику на оверлей\nuseEffect(function(){function handleEscClose(event){if(event.key===\"Escape\"){closeAllPopups();}}function handleClickOnOverlay(event){var popup=document.querySelector(\".popup_opened\");if(event.target!==popup){return;}closeAllPopups();}document.addEventListener(\"click\",handleClickOnOverlay);document.addEventListener(\"keydown\",handleEscClose);return function(){document.removeEventListener(\"keydown\",handleEscClose);document.removeEventListener(\"click\",handleClickOnOverlay);};},[]);//  Поставить/снять лайк\nfunction handleCardLike(card){var isLiked=card.likes.some(function(i){return i._id===currentUser._id;});api.changeLikeCardStatus(card._id,!isLiked).then(function(newCard){var newCards=cards.map(function(c){return c._id===card._id?newCard:c;});setCards(newCards);}).catch(function(err){console.log(err);});}//  Удалить карточку\nfunction handleCardDelete(card){setValueInput(_objectSpread(_objectSpread({},valueInput),{},{confirm:\"Удаление...\"}));api.deleteCard(card._id).then(function(){var newCards=cards.filter(function(c){return c._id!==card._id;});setCards(newCards);}).then(function(){closeAllPopups();setValueInput(_objectSpread(_objectSpread({},valueInput),{},{confirm:\"Да\"}));}).catch(function(err){console.log(err);});}//  Добавить карточку\nfunction handleAddPlaceSubmit(_ref){var name=_ref.name,link=_ref.link;setValueInput(_objectSpread(_objectSpread({},valueInput),{},{submit:\"Сохранение...\"}));api.addNewCard(name,link).then(function(card){setCards([card].concat(_toConsumableArray(cards)));}).then(function(){setValueInput(_objectSpread(_objectSpread({},valueInput),{},{submit:\"Сохранить\"}));closeAllPopups();}).catch(function(err){console.log(err);});}//  Обновить аватар\nfunction handleUpdateAvatar(_ref2){var avatar=_ref2.avatar;setValueInput(_objectSpread(_objectSpread({},valueInput),{},{submit:\"Сохранение...\"}));api.setUserAvatar(avatar).then(function(){setCurrentUser(_objectSpread(_objectSpread({},currentUser),{},{avatar:avatar}));}).then(function(){closeAllPopups();setValueInput(_objectSpread(_objectSpread({},valueInput),{},{submit:\"Сохранить\"}));}).catch(function(err){console.log(err);});}//  Обновить данные пользователя\nfunction handleUpdateUser(_ref3){var name=_ref3.name,about=_ref3.about;setValueInput(_objectSpread(_objectSpread({},valueInput),{},{submit:\"Сохранение...\"}));api.setUserInfo(name,about).then(function(){setCurrentUser(_objectSpread(_objectSpread({},currentUser),{},{name:name,about:about}));}).then(function(){closeAllPopups();setValueInput(_objectSpread(_objectSpread({},valueInput),{},{submit:\"Сохранить\"}));}).catch(function(err){console.log(err);});}//  Присвоить значения карточке\nfunction handleCardClick(card){setSelectedCard(card);}//  Открыть попап редактирования профиля\nfunction handleEditProfileClick(){setIsEditProfilePopupOpen(true);}//  Открыть попап добавдения новой карточки\nfunction handleAddPlaceClick(){setIsAddPlacePopupOpen(true);}//  Открыть попап редактирования аватара\nfunction handleEditAvatarClick(){setIsEditAvatarPopupOpen(true);setNameValid(true);}//  Открыть попап подтверждения удаления карточки\nfunction handleDeleteButtonClick(card){setIsConfirmPopupOpen(true);setDeleteCard(card);setNameValid(true);setDescriptionValid(true);}//  Закрыть все попапы\nfunction closeAllPopups(){setIsEditProfilePopupOpen(false);setIsAddPlacePopupOpen(false);setIsEditAvatarPopupOpen(false);setSelectedCard(false);setIsConfirmPopupOpen(false);setNameValid(false);setDescriptionValid(false);}return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsxs(\"div\",{className:\"root\",children:[/*#__PURE__*/_jsx(Header,{}),currentUser&&/*#__PURE__*/_jsx(Main,{onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,onEditAvatar:handleEditAvatarClick,onCardClick:handleCardClick,cards:cards,onCardLike:handleCardLike,onConfirmDelete:handleDeleteButtonClick,handleChangeName:handleChangeName}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(ConfirmPopup,{isOpen:isConfirmPopupOpen,onClose:closeAllPopups,onCardDelete:handleCardDelete,card:deleteCard,valueInput:valueInput.confirm,formValid:formValid}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit,valueInput:valueInput.submit,nameError:nameError,descriptionError:descriptionError,handleChangeName:handleChangeName,handleChangeDescription:handleChangeDescription,formValid:formValid}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar,valueInput:valueInput.submit,descriptionError:descriptionError,handleChangeDescription:handleChangeDescription,formValid:formValid}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser,valueInput:valueInput.submit,nameError:nameError,descriptionError:descriptionError,handleChangeName:handleChangeName,handleChangeDescription:handleChangeDescription,formValid:formValid}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,onClose:closeAllPopups})]})});}export default App;","map":{"version":3,"sources":["/Users/timurmarokko/Desktop/dev/react-mesto-auth/src/components/App.js"],"names":["React","useState","useEffect","Header","Main","Footer","EditProfilePopup","EditAvatarPopup","ImagePopup","api","CurrentUserContext","ConfirmPopup","AddPlacePopup","App","isEditProfilePopupOpen","setIsEditProfilePopupOpen","isAddPlacePopupOpen","setIsAddPlacePopupOpen","isEditAvatarPopupOpen","setIsEditAvatarPopupOpen","isConfirmPopupOpen","setIsConfirmPopupOpen","selectedCard","setSelectedCard","deleteCard","setDeleteCard","currentUser","setCurrentUser","cards","setCards","submit","confirm","valueInput","setValueInput","nameError","setNameError","descriptionError","setDescriptionError","formValid","setFormValid","nameValid","setNameValid","descriptionValid","setDescriptionValid","handleChangeName","event","target","validity","valid","validationMessage","handleChangeDescription","getUserInfo","then","data","catch","err","console","log","getInitialCards","handleEscClose","key","closeAllPopups","handleClickOnOverlay","popup","document","querySelector","addEventListener","removeEventListener","handleCardLike","card","isLiked","likes","some","i","_id","changeLikeCardStatus","newCard","newCards","map","c","handleCardDelete","filter","handleAddPlaceSubmit","name","link","addNewCard","handleUpdateAvatar","avatar","setUserAvatar","handleUpdateUser","about","setUserInfo","handleCardClick","handleEditProfileClick","handleAddPlaceClick","handleEditAvatarClick","handleDeleteButtonClick"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Header from \"./Header\";\nimport Main from \"./Main\";\nimport Footer from \"./Footer\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport ImagePopup from \"./ImagePopup\";\nimport api from \"../utils/api\";\nimport { CurrentUserContext } from \"../contexts/CurrentUserContext\";\nimport ConfirmPopup from \"./ConfirmPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\n\nfunction App() {\n    const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = useState(false);\n    const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = useState(false);\n    const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] = useState(false);\n    const [isConfirmPopupOpen, setIsConfirmPopupOpen] = useState(false);\n    const [selectedCard, setSelectedCard] = useState(false);\n    const [deleteCard, setDeleteCard] = useState(false);\n    const [currentUser, setCurrentUser] = useState({});\n    const [cards, setCards] = useState([]);\n    const [valueInput, setValueInput] = useState({\n        submit: \"Сохранить\",\n        confirm: \"Да\",\n    });\n\n    const [nameError, setNameError] = useState(\"\");\n    const [descriptionError, setDescriptionError] = useState(\"\");\n    const [formValid, setFormValid] = useState(false);\n    const [nameValid, setNameValid] = useState(false);\n    const [descriptionValid, setDescriptionValid] = useState(false);\n\n    // Валидация изменения имени и названия\n    function handleChangeName(event) {\n        if (event.target.validity.valid) {\n            setNameError(\"\");\n            setNameValid(true);\n        } else {\n            setNameError(event.target.validationMessage);\n            setNameValid(false);\n        }\n    }\n    // Валидация изменения описания и ссылок\n    function handleChangeDescription(event) {\n        if (event.target.validity.valid) {\n            setDescriptionError(\"\");\n            setDescriptionValid(true);\n        } else {\n            setDescriptionError(event.target.validationMessage);\n            setDescriptionValid(false);\n        }\n    }\n\n    useEffect(() => {\n        if (!nameValid || !descriptionValid) {\n            setFormValid(false);\n        } else {\n            setFormValid(true);\n        }\n        return () => {\n            setFormValid(false);\n        };\n    }, [nameValid, descriptionValid]);\n\n\n    // useEffect(() => {\n    //     if (nameError || descriptionError) {\n    //         setFormValid(false);\n    //     } else {\n    //         setFormValid(true);\n    //     }\n    // },[nameError, descriptionError]);\n\n    // Получение данных пользователя с сервера\n    useEffect(() => {\n        api.getUserInfo()\n            .then((data) => {\n                setCurrentUser(data);\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    }, []);\n\n    // Получение карточек с сервера\n    useEffect(() => {\n        api.getInitialCards()\n            .then((cards) => {\n                setCards(cards);\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    }, []);\n\n    //  Закрытие попапа по Esc и клику на оверлей\n    useEffect(() => {\n        function handleEscClose(event) {\n            if (event.key === \"Escape\") {\n                closeAllPopups();\n            }\n        }\n\n        function handleClickOnOverlay(event) {\n            const popup = document.querySelector(\".popup_opened\");\n            if (event.target !== popup) {\n                return;\n            }\n            closeAllPopups();\n        }\n\n        document.addEventListener(\"click\", handleClickOnOverlay);\n        document.addEventListener(\"keydown\", handleEscClose);\n\n        return () => {\n            document.removeEventListener(\"keydown\", handleEscClose);\n            document.removeEventListener(\"click\", handleClickOnOverlay);\n        };\n    }, []);\n\n    //  Поставить/снять лайк\n    function handleCardLike(card) {\n        const isLiked = card.likes.some((i) => i._id === currentUser._id);\n\n        api.changeLikeCardStatus(card._id, !isLiked)\n            .then((newCard) => {\n                const newCards = cards.map((c) =>\n                    c._id === card._id ? newCard : c\n                );\n                setCards(newCards);\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    }\n\n    //  Удалить карточку\n    function handleCardDelete(card) {\n        setValueInput({\n            ...valueInput,\n            confirm: \"Удаление...\",\n        });\n        api.deleteCard(card._id)\n            .then(() => {\n                const newCards = cards.filter((c) => c._id !== card._id);\n                setCards(newCards);\n            })\n            .then(() => {\n                closeAllPopups();\n                setValueInput({\n                    ...valueInput,\n                    confirm: \"Да\",\n                });\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    }\n\n    //  Добавить карточку\n    function handleAddPlaceSubmit({ name, link }) {\n        setValueInput({\n            ...valueInput,\n            submit: \"Сохранение...\",\n        });\n        api.addNewCard(name, link)\n            .then((card) => {\n                setCards([card, ...cards]);\n            })\n            .then(() => {\n                setValueInput({\n                    ...valueInput,\n                    submit: \"Сохранить\",\n                });\n                closeAllPopups();\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    }\n    //  Обновить аватар\n    function handleUpdateAvatar({ avatar }) {\n        setValueInput({\n            ...valueInput,\n            submit: \"Сохранение...\",\n        });\n        api.setUserAvatar(avatar)\n            .then(() => {\n                setCurrentUser({\n                    ...currentUser,\n                    avatar: avatar,\n                });\n            })\n            .then(() => {\n                closeAllPopups();\n                setValueInput({\n                    ...valueInput,\n                    submit: \"Сохранить\",\n                });\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    }\n    //  Обновить данные пользователя\n    function handleUpdateUser({ name, about }) {\n        setValueInput({\n            ...valueInput,\n            submit: \"Сохранение...\",\n        });\n        api.setUserInfo(name, about)\n            .then(() => {\n                setCurrentUser({\n                    ...currentUser,\n                    name: name,\n                    about: about,\n                });\n            })\n            .then(() => {\n                closeAllPopups();\n                setValueInput({\n                    ...valueInput,\n                    submit: \"Сохранить\",\n                });\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    }\n    //  Присвоить значения карточке\n    function handleCardClick(card) {\n        setSelectedCard(card);\n    }\n\n    //  Открыть попап редактирования профиля\n    function handleEditProfileClick() {\n        setIsEditProfilePopupOpen(true);\n    }\n    //  Открыть попап добавдения новой карточки\n    function handleAddPlaceClick() {\n        setIsAddPlacePopupOpen(true);\n    }\n    //  Открыть попап редактирования аватара\n    function handleEditAvatarClick() {\n        setIsEditAvatarPopupOpen(true);\n        setNameValid(true)\n    }\n    //  Открыть попап подтверждения удаления карточки\n    function handleDeleteButtonClick(card) {\n        setIsConfirmPopupOpen(true);\n        setDeleteCard(card);\n        setNameValid(true)\n        setDescriptionValid(true)\n\n    }\n    //  Закрыть все попапы\n    function closeAllPopups() {\n        setIsEditProfilePopupOpen(false);\n        setIsAddPlacePopupOpen(false);\n        setIsEditAvatarPopupOpen(false);\n        setSelectedCard(false);\n        setIsConfirmPopupOpen(false);\n        setNameValid(false)\n        setDescriptionValid(false)\n    }\n\n    return (\n        <CurrentUserContext.Provider value={currentUser}>\n            <div className=\"root\">\n                <Header />\n                {currentUser && (\n                    <Main\n                        onEditProfile={handleEditProfileClick}\n                        onAddPlace={handleAddPlaceClick}\n                        onEditAvatar={handleEditAvatarClick}\n                        onCardClick={handleCardClick}\n                        cards={cards}\n                        onCardLike={handleCardLike}\n                        onConfirmDelete={handleDeleteButtonClick}\n                        handleChangeName={handleChangeName}\n                    />\n                )}\n                <Footer />\n                <ConfirmPopup\n                    isOpen={isConfirmPopupOpen}\n                    onClose={closeAllPopups}\n                    onCardDelete={handleCardDelete}\n                    card={deleteCard}\n                    valueInput={valueInput.confirm}\n                    formValid={formValid}\n                />\n                <AddPlacePopup\n                    isOpen={isAddPlacePopupOpen}\n                    onClose={closeAllPopups}\n                    onAddPlace={handleAddPlaceSubmit}\n                    valueInput={valueInput.submit}\n                    nameError={nameError}\n                    descriptionError={descriptionError}\n                    handleChangeName={handleChangeName}\n                    handleChangeDescription={handleChangeDescription}\n                    formValid={formValid}\n                />\n                <EditAvatarPopup\n                    isOpen={isEditAvatarPopupOpen}\n                    onClose={closeAllPopups}\n                    onUpdateAvatar={handleUpdateAvatar}\n                    valueInput={valueInput.submit}\n                    descriptionError={descriptionError}\n                    handleChangeDescription={handleChangeDescription}\n                    formValid={formValid}\n                />\n                <EditProfilePopup\n                    isOpen={isEditProfilePopupOpen}\n                    onClose={closeAllPopups}\n                    onUpdateUser={handleUpdateUser}\n                    valueInput={valueInput.submit}\n                    nameError={nameError}\n                    descriptionError={descriptionError}\n                    handleChangeName={handleChangeName}\n                    handleChangeDescription={handleChangeDescription}\n                    formValid={formValid}\n                />\n\n                <ImagePopup card={selectedCard} onClose={closeAllPopups} />\n            </div>\n        </CurrentUserContext.Provider>\n    );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}